# Chat Konyaku
### これは何？
これはTree of savior用アドオンです。  
<br>
Tree of saviorはワールド統合され、チャットには英語や韓国語（ハングル）が流れるようになりました。  
チャットに読めない文字が流れてくるとなんかモヤモヤする……。  
ToSに備わっている翻訳機能はいちいち選択して翻訳操作しなくちゃいけないし、パーティリンクとか含んでると翻訳もできない。  
超不便……というわけで作ってみました。  
<br>
ToS翻訳アプリと連動して韓国語を日本語訳して表示する機能を持っています。  
ただしアドオン単体では機能しません。  
別リポジトリに上げているToS翻訳アプリを起動しておくことでアドオンと連携し、翻訳APIの翻訳結果をToS上で表現します。  
<br>
ちなみに**Honyaku**でなく**Konyaku**なのはわりとガチでタイプミスだが、あながち間違ってないので採用しちゃった。
<br>
### ざっと機能一覧
* 翻訳するのは韓国語のみ。英語はがんばって読んでください
* 翻訳に利用できるAPIは２種類
  * みんなの自動翻訳
  * DeepL
* 翻訳後チャットへの反映方法は以下２種類のうちどちらかを選択
  * 原文に追記
  * 原文を置き換え
* メッセージの書き換えはローカル表示のみでサーバのメッセージは書き換えない。というかできない<br>（だからMAP移動などすると元の韓国語に戻る）
* パーティ名は翻訳するとたぶん機能しなくなるので翻訳せずハングルのまま表示
* chatextendsが入ってても動くようにしてある（※ニコニコモードは対象外）
<br>

## 導入する前に注意
各翻訳サービスでは、**学習に利用されることがあるため個人情報を送信しないように求めています**が、  
本アプリケーションではチャットの内容を自動送信するため、個人情報の有無を判別できません。  
DeepLは個人情報の送信があり得る場合、有償サービスの契約を求めています。  
どうしても無償版で利用したい場合はこの旨を理解した上でご利用ください。  
<br>
**なお本アプリケーション、アドオンを利用したことにより生じるいかなる損害についても、理由の如何に関わらず作者は責任を負えません。  
くれぐれも自己の責任においてご利用ください。**
<br>
<br>
## 導入手順
#### ［ToS翻訳ツールの導入と設定］
　**（※環境によっては.NET Framework 4.7.2ラインタイムのインストールが必要かも。別途インストールしてください）**  
1. みんなの自動翻訳、DeepL翻訳ツールにアカウント登録（どちらか片方でも良い）  
2. TosTranslateリポジトリ[]()からToS翻訳アプリをダウンロード  
3. 解凍したらToSTranslator.exeを起動  
4. 注意事項をしっかり読む（※しっかり読んでね！）  
5. 翻訳キー等を設定（※各翻訳サービスで登録した後に貰える情報を入れる）  
  ![image](https://github.com/mamao11/ToSAddons/assets/36460192/e045aea2-76de-44bd-996f-08e7b392988c)  
上記はみんなの自動翻訳の例。各サイトのどこ見たら良いかはこのページ最下部参照。
6. 翻訳APIをプルダウンから指定  
  ![image](https://github.com/mamao11/ToSAddons/assets/36460192/ecb39d93-c414-4ef3-af71-cfa26f37264d)  

7. ステータスボックスが青色（翻訳は緑色）になったらToS翻訳ツールの準備OK  
  ![image](https://github.com/mamao11/ToSAddons/assets/36460192/a80330c5-5d86-45fe-916c-401c17386f1d)  
  
#### ［ToSアドオンの導入］

1. [ここから](https://github.com/mamao11/ToSAddons/releases/tag/v0.0.1)chatkonyaku-v0.0.1.zipをダウンロードして適当なフォルダに解凍  
2. 解凍して出てきた「ToSインストール先フォルダ\data」フォルダへchatkonyaku-📖-v0.0.1.ipfをコピー  
  （※アドオンマネージャに登録してないので手でコピーしてね）  
  
以上で導入完了。  
<br>
## 起動してみる
ToSを起動。MAPにログインしてみる  
**※起動順はToS翻訳アプリ→ToSの順です。逆にすると翻訳できません。**  

システムメッセージでこんな感じのメッセージが出る。  
  
 ![image](https://github.com/mamao11/ToSAddons/assets/36460192/65304751-d020-4f7e-81cb-3dd1dbf0c8e3)  
大事なのは送信-OK、受信-OKの文字  
<br>
そしてToS翻訳アプリのステータスボックスが青から緑に変われば接続OK  
  
 ![image](https://github.com/mamao11/ToSAddons/assets/36460192/535c4ad7-45df-435f-a37e-feb59a1934ea)  

あとは韓国語で発言されれば自動的に翻訳され、数秒後にチャットに反映される。  
  
 ![image](https://github.com/mamao11/ToSAddons/assets/36460192/2e86953e-63e0-4fc8-b751-bae8482899bb)  
上の例は**原文を置き換え**の例。赤い菱形は翻訳された文章を示すマーク。  
<br>
 ![image](https://github.com/mamao11/ToSAddons/assets/36460192/c943fa37-14ee-46bf-862e-ccafb1a57dfb)  
こっちは**原文に追記**の例。後ろに括弧付きでやや暗い白で表現される
<br>
<br>
<br>
## ［トラブルかな？］
**1. パーティ名が翻訳できてない？**  
  　パーティ名はあえて翻訳してません。翻訳してしまうと別物になってクリックしても機能しないと思うので。（たぶん）  
   <br>
**2. 画面上部に流れるシャウトが翻訳されないんだけど**  
  　翻訳するのはチャット窓内だけです。上部シャウトは翻訳しません。  
   <br>
**3. 翻訳失敗と表示されるんだが？**  
  　各サービスにおいて翻訳回数等の制限がある。  
  　みんなの自動翻訳は日単位。DeepLは月単位の制限のもよう。  
<br>
  　制限にひっかかるとToSチャット欄は「翻訳失敗」と表示され、ToS翻訳アプリにERROR表示が出ます。  
  　制限にひっかかったら諦めて翻訳APIを切り替えてください。  
<br>
<br>
<br>
## ［翻訳API設定の必要な情報ってどこにあるの？］
#### みんなの自動翻訳の場合はWebAPIページの中
![image](https://github.com/mamao11/ToSAddons/assets/36460192/387e8e1f-5cd8-49c3-857e-b36cfc898a20)  
ログイン後の雲マークをクリックし、言語を**韓国語→日本語**にし、対話NT（音声翻訳エンジン専用）の右端の青いiマークをクリック。  
（※いくつか試したけどこれが一番自然に感じた）<br>
<br>
するとAPI Keyなどの情報が出てくる。  
![image](https://github.com/mamao11/ToSAddons/assets/36460192/d2feda74-97a0-495d-95db-33fdf278a15c)  
<br>
#### DeepLの場合はアカウント情報の中
![image](https://github.com/mamao11/ToSAddons/assets/36460192/2e5445bf-3b41-4a46-8c52-c640e98aeade)  
<br>
下の方にスクロールすると**DeepL APIで使用する認証キー**の欄がある。  
![image](https://github.com/mamao11/ToSAddons/assets/36460192/7a37c938-2626-474a-95df-abf4b02ee133)  
<br>
<br>
